\subsubsection{概要}EssentialParticleJクラスは相互作用の計算に必要なj粒子情報を持つクラスである。FDPSの内部では、このクラスがFullParticleクラスから情報を読み取る。情報を読み取るために、このクラスはいくつかのメンバ関数を持つ必要がある。以下、この節の前提、常に必要なメンバ関数と、場合によっては必要なメンバ関数について記述する。\subsubsection{前提}この節の中では、名前空間ParticleSimulatorをPSと省略する。このクラスのクラス名をEssentialParticleJとする。また、粒子すべての情報を持つクラスのクラス名をFullParticleとする。このFullParticleは節\ref{sec:fullparticle}のクラスFullParticleと同一のものである。EssentialParticleJ, FullParticleというクラス名は変更可能である。ParticleSimulatorをPSと省略すること、EssentialParticleJとFullParticleの宣言は以下の通りである。\begin{screen}\begin{verbatim}namespace PS = ParticleSimulator;class FullParticle;class EssentialParticleJ;\end{verbatim}\end{screen}\subsubsection{必要なメンバ関数}\subsubsubsection{概要}常に必要なメンバ関数はgetPosとCopyfromFPである。getPosはEssentialParticleJクラスの位置情報をFDPSに読み込ませるための関数で、copyFromFPはFullParticleクラスの情報をEssentialParticleJクラスに書きこむ関数である。これらのメンバ関数の記述例と解説を以下に示す。\subsubsubsection{getPos}\begin{screen}\begin{verbatim}class EssentialParticleJ {public:    PS::F64vec pos;    PS::F64vec getPos() const {        return this->pos;    }};\end{verbatim}\end{screen}\begin{itemize}\item {\bf 前提}    EssentialParticleJのメンバ変数posはある１つの粒子の位置情報。このposのデー  タ型はPS::F64vec型。  \item {\bf 引数}  なし  \item {\bf 返値}  PS::F64vec型。EssentialParticleJクラスの位置情報を保持したメンバ変数。  \item {\bf 機能}  EssentialParticleJクラスの位置情報を保持したメンバ変数を返す。  \item {\bf 備考}  EssentialParticleJクラスのメンバ変数posの変数名は変更可能。\end{itemize}\subsubsubsection{copyFromFP}\begin{screen}\begin{verbatim}class FullParticle {public:    PS::S64    identity;    PS::F64    mass;    PS::F64vec position;    PS::F64vec velocity;    PS::F64vec acceleration;    PS::F64    potential;};class EssentialParticleJ {public:    PS::S64    id;    PS::F64    m;    PS::F64vec pos;    void copyFromFP(const FullParticle & fp) {        this->id  = fp.identity;        this->m   = fp.mass;        this->pos = fp.position;    }};\end{verbatim}\end{screen}\begin{itemize}\item {\bf 前提}  FullParticleクラスのメンバ変数identity, mass, positionと  EssentialParticleJクラスのメンバ変数id, m, posはそれぞれ対応する情報  を持つ。\item {\bf 引数}  fp: 入力。const FullParticle \&型。FullParticleクラスの情報を持つ。  \item {\bf 返値}  なし。  \item {\bf 機能}  FullParticleクラスの持つ１粒子の情報の一部をEssnetialParticleJクラス  に書き込む。  \item {\bf 備考}  Fullparticeクラスのメンバ変数の変数名、EssentialParticleJクラスのメ  ンバ変数の変数名は変更可能。メンバ関数EssentialParticleJ::copyFromFP  の引数名は変更可能。EssentialParticleJクラスの粒子情報はFullParticle  クラスの粒子情報のサブセット。対応する情報を持つメンバ変数同士のデー  タ型が一致している必要はないが、実数型とベクトル型(または整数型とベ  クトル型)という違いがある場合に正しく動作する保証はない。\end{itemize}\subsubsection{場合によっては必要なメンバ関数}\subsubsubsection{概要}本節では、場合によっては必要なメンバ関数について記述する。相互作用ツリークラスのSEARCH\_MODE型にSEARCH\_MODE\_LONG以外を用いる場合に必要なメンバ関数、列挙型のBOUNDARY\_CONDITION型にPS::BOUNDARY\_CONDITION\_OPEN以外を選んだ場合に必要となるメンバ関数について記述する。\subsubsubsection{相互作用ツリークラスのSEARCH\_MODE型にSEARCH\_MODE\_LONG以外を用いる場合}\subsubsubsubsection{getRsearch}\begin{screen}\begin{verbatim}class EssentialParticleJ {public:    PS::F64 search_radius;    PS::F64 getRsearch() const {        return this->search_radius;    }};\end{verbatim}\end{screen}\begin{itemize}\item {\bf 前提}  EssentialParticleJクラスのメンバ変数search\_radiusはある１つの粒子の  近傍粒子を探す半径の大きさ。このsearch\_radiusのデータ型はPS::F32型  またはPS::F64型。  \item {\bf 引数}  なし  \item {\bf 返値}  PS::F32型またはPS::F64型。 EssentialParticleJクラスの近傍粒子を探す  半径の大きさを保持したメンバ変数。  \item {\bf 機能}  EssentialParticleJクラスの近傍粒子を探す半径の大きさを保持したメンバ  変数を返す。\item {\bf 備考}  EssentialParticleJクラスのメンバ変数search\_radiusの変数名は変更可能。  \end{itemize}\subsubsubsection{BOUNDARY\_CONDITION型にPS::BOUNDARY\_CONDITION\_OPEN以外を用いる場合}\subsubsubsubsection{setPos}\begin{screen}\begin{verbatim}class EssentialParticleJ {public:    PS::F64vec pos;    void setPos(const PS::F64vec pos_new) {        this->pos = pos_new;    }};\end{verbatim}\end{screen}\begin{itemize}\item {\bf 前提}    EssentialParticleJクラスのメンバ変数posは１つの粒子の位置情報。この  posのデータ型はPS::F32vecまたはPS::F64vec。EssentialParticleJクラス  のメンバ変数posの元データとなっているのはFullParticleクラスのメンバ  変数position。このデータ型はPS::F32vecまたはPS::F64vec。\item {\bf 引数}  pos\_new: 入力。const PS::F32vecまたはconst PS::F64vec型。FDPS側で修  正した粒子の位置情報。\item {\bf 返値}  なし。  \item {\bf 機能}  FDPSが修正した粒子の位置情報をEssentialParticleJクラスの位置情報に書き込む。\item {\bf 備考}  EssentialParticleJクラスのメンバ変数posの変数名は変更可能。メンバ関  数EssentialParticleJ::setPosの引数名pos\_newは変更可能。posと  pos\_newのデータ型が異なる場合の動作は保証しない。\end{itemize}